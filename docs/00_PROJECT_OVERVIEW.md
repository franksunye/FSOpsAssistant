# FSOA 项目概述

Field Service Operations Assistant - 现场服务运营助手

## 1. 项目背景

### 业务痛点
- **人工监控效率低**：运营人员需要手动跟踪现场服务时效
- **响应不及时**：超时情况发现和处理存在延迟
- **重复性工作多**：大量时间花费在状态检查和提醒发送上
- **缺乏智能决策**：依赖人工经验判断，缺乏数据驱动的决策支持

### 解决方案
构建一个具备**主动性、自主决策、目标导向**的AI Agent系统，实现：
- 自动监控现场服务时效状态
- 智能判断和发送超时提醒
- 通过企业微信群自动通知相关人员
- 提升运营效率，减少人工干预

## 2. 项目目标

### 业务目标
- **提升时效合规率**：通过及时提醒提高现场服务SLA达成率
- **降低运营成本**：减少人工监控和提醒工作量
- **增强响应速度**：实现实时监控和即时通知
- **改善服务质量**：通过数据驱动优化服务流程

### 技术目标
- **验证Agentic AI**：体现主动性、自主决策、目标导向特性
- **探索LLM应用边界**：明确哪些场景需要LLM，哪些不需要
- **建立可扩展架构**：为未来功能扩展奠定基础
- **实现非侵入式集成**：不影响现有业务系统

## 3. 核心特性

### 3.1 Agentic特性
```
主动性 (Proactive)
├── 定时自动扫描商机状态
├── 主动识别超时风险
├── 智能缓存和数据刷新
└── 无需人工触发的自动化流程

自主决策 (Autonomous)
├── 规则引擎 + LLM混合决策
├── 基于上下文的智能判断
├── 分级通知路由决策
└── 自适应策略调整

目标导向 (Goal-Oriented)
├── 以提升时效合规为目标
├── 结果驱动的行为优化
└── 持续学习和改进
```

### 3.2 技术特性
- **非侵入式**：通过Metabase API获取数据，不修改现有系统
- **管理器架构**：BusinessDataStrategy、NotificationTaskManager、AgentExecutionTracker三大核心管理器
- **智能缓存**：支持TTL缓存、手动刷新、数据一致性验证
- **分级通知**：组织级通知路由、升级机制、频率控制
- **混合决策**：结合规则引擎和LLM的智能决策
- **完整追踪**：Agent执行生命周期管理和详细状态记录
- **可观测性**：结构化日志、性能指标、错误追踪
- **可配置性**：数据库+环境变量的灵活配置方案

## 4. 系统架构概览

```
数据流向：
Metabase → Agent Engine → Decision Engine → Notification → Feedback Loop
   ↓           ↓              ↓              ↓           ↓
业务数据 → 状态分析 → 智能决策 → 消息发送 → 效果评估

技术栈：
┌─────────────┐  ┌─────────────┐  ┌─────────────┐
│  Frontend   │  │   Backend   │  │   Storage   │
│             │  │             │  │             │
│ Streamlit   │  │ LangGraph   │  │  SQLite     │
│ Web UI      │  │ Agent       │  │  Database   │
│             │  │ Engine      │  │             │
└─────────────┘  └─────────────┘  └─────────────┘
       │                │                │
       └────────────────┼────────────────┘
                        │
              ┌─────────────┐
              │ Integration │
              │             │
              │ Metabase    │
              │ WeChat      │
              │ DeepSeek    │
              └─────────────┘
```

## 5. 核心业务流程

### 5.1 主流程
```
1. 定时触发 (每小时)
   ↓
2. 从Metabase获取任务数据
   ↓
3. 分析任务状态和时效
   ↓
4. 决策是否需要提醒
   ├── 规则判断：基于SLA时间
   └── LLM推理：优先级和内容优化
   ↓
5. 发送企微通知
   ↓
6. 记录执行结果
   ↓
7. 更新任务状态
```

### 5.2 决策逻辑
```python
# 混合决策示例
def decide_action(task):
    # 规则引擎：硬性判断
    if task.overdue_hours > task.sla_hours:
        priority = "high" if task.overdue_hours > task.sla_hours * 1.5 else "normal"
        
        # LLM推理：内容优化（可选）
        if use_llm_optimization:
            message = llm_generate_message(task, priority)
        else:
            message = template_message(task, priority)
            
        return {"action": "notify", "priority": priority, "message": message}
    
    return {"action": "skip"}
```

## 6. 价值主张

### 6.1 对运营人员
- **减少重复工作**：自动化监控和提醒，释放人力资源
- **提升响应速度**：实时监控，及时发现问题
- **数据驱动决策**：基于历史数据和智能分析的决策支持
- **工作质量提升**：减少人为遗漏，提高工作准确性

### 6.2 对组织
- **成本降低**：减少人工成本，提高运营效率
- **服务质量提升**：更好的时效管理，提升客户满意度
- **数字化转型**：引入AI技术，推动业务智能化
- **竞争优势**：先进的运营管理能力

### 6.3 对技术团队
- **技术探索**：验证Agentic AI在企业场景的应用
- **架构实践**：建立可扩展的AI Agent系统架构
- **经验积累**：积累LLM应用和Agent开发经验
- **创新驱动**：推动技术创新和业务创新结合

## 7. 项目状态

### 7.1 当前进展
- ✅ **Phase 1**: 基础架构搭建 (100% 完成)
- ✅ **Phase 2**: Agent核心功能 (100% 完成)
- ✅ **Phase 3**: 功能完善和测试 (100% 完成)
- 🔄 **Phase 4**: 真实业务集成 (80% 完成)
- 📋 **Phase 5**: 生产优化和扩展 (规划中)

### 7.2 真实业务集成成果
- ✅ **Metabase集成**: 成功连接Card 1712，获取47条真实商机数据
- ✅ **业务逻辑验证**: SLA规则和逾期检测完全正常
- ✅ **数据分析**: 识别出31个逾期商机，涉及10个组织
- 🔄 **通知系统**: 企微群分级通知机制开发中

## 8. 成功指标

### 8.1 业务指标
- **时效合规率提升**：目标提升20%以上
- **响应时间缩短**：从小时级降低到分钟级
- **人工工作量减少**：减少80%的重复性监控工作
- **客户满意度提升**：通过更好的服务时效管理

### 8.2 技术指标
- **系统可用性**：99%以上的稳定运行
- **响应准确性**：95%以上的正确决策率
- **处理效率**：支持1000+任务的并发处理
- **扩展性验证**：成功支持新业务场景接入

## 9. 风险控制

### 9.1 技术风险
- **API依赖**：Metabase和企微API的稳定性风险
- **LLM可用性**：DeepSeek服务中断的降级方案
- **数据准确性**：数据源异常的检测和处理

### 9.2 业务风险
- **过度通知**：频率控制和智能去重机制
- **误判风险**：人工审核和反馈机制
- **隐私安全**：敏感信息的保护和脱敏

### 9.3 缓解措施
- **多重验证**：规则+LLM的双重验证机制
- **降级方案**：纯规则模式作为LLM的备选方案
- **监控告警**：完善的系统监控和异常告警
- **人工干预**：保留人工审核和调整能力

---
> 项目概述文档作为项目的北极星，指导整个开发过程
